queryURL(),modeCheck(),$(document).ready((function(){subfolderCheck(),injectFont(),injectCloseWindow(),buildMenu(),updatePopUps(),$("#menuButton").on("click",openVertMenu)}));var enableConsoleLogging=!1,url=window.location.href,regex=new RegExp(contentsData.homeFolderName+".*","g"),urlmatch=url.match(regex),folderDepth=0,folderPath="";function subfolderCheck(){for(enableConsoleLogging&&console.log(url),enableConsoleLogging&&console.log(folderDepth),i=0;i<folderDepth;i++)folderPath+="../";enableConsoleLogging&&console.log("folderPath: ",folderPath)}function injectCloseWindow(){$("body").prepend('<div id="closeWindow" onclick="closeAll()"></div>')}function injectFont(){$("head").append('\x3c!-- imported fonts --\x3e<link href="https://fonts.googleapis.com/css?family=Nunito&display=swap" rel="stylesheet">')}function checkWidth(){var buildWidth=$(window).width();const WINDOW_WIDTH_FOR_MENUSWITCH=contentsData.menuStyleSwitch;var horizontalMenu=!0,verticalMenu=!1;if(buildWidth>=WINDOW_WIDTH_FOR_MENUSWITCH)$(".horizMenu").css("display","inline-flex"),$("#toggleMenuNoHover").css("display","none"),$("#openSidebarMenu").prop("checked",!1),$(".vertMenuCont").slideUp(),horizontalMenu=!0,verticalMenu=!1,closeMenus();else{if(!(buildWidth<WINDOW_WIDTH_FOR_MENUSWITCH))return void(enableConsoleLogging&&console.log("Error - Returning from checkWidth()"));$(".horizMenu").css("display","none"),$("#toggleMenuNoHover").css("display","block"),horizontalMenu=!1,verticalMenu=!0,closeMenus()}}function buildMenu(){if(contentsData.menuBarContents){for(var output="",submenuCount=0,i=0;i<contentsData.menuBarContents.length;i++){if(null!==contentsData.menuBarContents[i].submenu?output+='<li class="menuDrop horizMenu">':null==contentsData.menuBarContents[i].submenu&&(output+='<li class="horizMenu">'),null!==contentsData.menuBarContents[i].link?output+='<a  href="'+folderPath+contentsData.menuBarContents[i].link+'"':null==contentsData.menuBarContents[i].link&&(output+='<a  href="javascript:void(null);"'),null!==contentsData.menuBarContents[i].code&&(output+=contentsData.menuBarContents[i].code),null!==contentsData.menuBarContents[i].submenu&&(output+=' onclick="openDropDown('+submenuCount+');"'),output+=">"+contentsData.menuBarContents[i].name,null!==contentsData.menuBarContents[i].submenu&&(output+="..."),output+="</a>",null!==contentsData.menuBarContents[i].submenu)for(var submenuOut="",j=0;j<contentsData.menuBarContents[i].submenu.length;j++)submenuOut+='<li class="horizMenuSub">',null!==contentsData.menuBarContents[i].submenu[j].link?submenuOut+='<a href="'+folderPath+contentsData.menuBarContents[i].submenu[j].link+'"':null==contentsData.menuBarContents[i].submenu[j].link&&(submenuOut+='<a href="javascript:void(null);"'),null!==contentsData.menuBarContents[i].submenu[j].code&&(submenuOut+=contentsData.menuBarContents[i].submenu[j].code),submenuOut+=">"+contentsData.menuBarContents[i].submenu[j].name+"</a></li>";null!==contentsData.menuBarContents[i].submenu&&(output+='<ul class="horizSubMenuCont submenu" id="submenu'+submenuCount+'">'+submenuOut+"</ul>",submenuCount++),output+="</li>"}$("#horizontalMenu").html(output);for(var output="",i=0;i<contentsData.menuBarContents.length;i++){if(null!==contentsData.menuBarContents[i].submenu?output+='<li class="menuDrop vertMenu">':null==contentsData.menuBarContents[i].submenu&&(output+='<li class="vertMenu" onclick="closeMenus()">'),null!==contentsData.menuBarContents[i].link?output+='<a  href="'+folderPath+contentsData.menuBarContents[i].link+'"':null==contentsData.menuBarContents[i].link&&(output+='<a  href="javascript:void(null);"'),null!==contentsData.menuBarContents[i].code&&(output+=contentsData.menuBarContents[i].code),null!==contentsData.menuBarContents[i].submenu&&(output+=' onclick="openDropDown('+submenuCount+');"'),output+=">"+contentsData.menuBarContents[i].name,null!==contentsData.menuBarContents[i].submenu?output+="... </a></li>":null==contentsData.menuBarContents[i].submenu&&(output+="</a></li>"),null!==contentsData.menuBarContents[i].submenu)for(var submenuOut="",j=0;j<contentsData.menuBarContents[i].submenu.length;j++)submenuOut+='<li class="vertMenuSub">',null!==contentsData.menuBarContents[i].submenu[j].link?submenuOut+='<a href="'+folderPath+contentsData.menuBarContents[i].submenu[j].link+'"':null==contentsData.menuBarContents[i].submenu[j].link&&(submenuOut+='<a href="javascript:void(null);"'),null!==contentsData.menuBarContents[i].submenu[j].code&&(submenuOut+=contentsData.menuBarContents[i].submenu[j].code),submenuOut+=">"+contentsData.menuBarContents[i].submenu[j].name+"</a></li>";null!==contentsData.menuBarContents[i].submenu&&(output+='<ul class="vertSubMenuCont submenu" id="submenu'+submenuCount+'">'+submenuOut+"</ul>",submenuCount++)}if($("#verticalMenu").html(output),!contentsData.menuStyleSwitch){var hm=$("#horizontalMenu"),logos=$("#menuTopLogoContainer");contentsData.menuStyleSwitch=hm.position().left+hm.width()+logos.width()}checkWidth(),$("#openSidebarMenu").prop("checked",!1),$(".submenu > li").on("click",closeMenus)}}urlmatch?(slashMatches=urlmatch[0].match(/\//g),folderDepth=slashMatches?slashMatches.length-contentsData.folderDepth:0,enableConsoleLogging&&console.log("folderDepth: "+folderDepth)):(folderDepth=0,console.warn("Regex is null or undefined, please ensure your homeFolderName and folderDepth are set properly in contents.js")),$(window).resize((function(){checkWidth()}));var menuDeployed=0;function openVertMenu(e){var panel=$(".vertMenuCont");0==menuDeployed?(panel.slideDown(),$("#closeWindow").css("visibility","visible"),menuDeployed=1):1==menuDeployed&&(panel.slideUp(),menuDeployed=0)}function openDropDown(dropdownID){$("menuSelected").removeAttr("menuSelected"),$(this).attr("id","menuSelected");var submenuCount=0;for(i=0;i<contentsData.menuBarContents.length;i++)null!==contentsData.menuBarContents[i].submenu&&(submenuCount+=2);for(i=0;i<submenuCount;i++)i!==dropdownID&&$("#submenu"+i).slideUp();$("#submenu"+dropdownID).slideToggle(),0==menuDeployed&&($("#closeWindow").css("visibility","visible"),menuDeployed=1)}function closeMenus(){1==menuDeployed&&($(".submenu").slideUp(),$("#verticalMenu").slideUp(),menuDeployed=0,$("#openSidebarMenu").prop("checked",!1))}function createWindow(name,size){var output="";for(i=0;i<contentsData.injection.length;i++)name==contentsData.injection[i].name&&createWindowHTML(output=(output=contentsData.injection[i].text).replace(/FOLDERPATH/g,folderPath),size);enableConsoleLogging&&console.log("createWindow() did not find: "+name)}function createWindowHTML(content,size){var window;"big"==size?(window=$("#bigWindow"),output='<div><button onclick="clearBigWindow()" class="closeButton" style="float: right;"><strong>X</strong></button></div>'):"normal"==size?(window=$("#window"),output='<div><button onclick="clearWindow()" class="closeButton" style="float: right;"><strong>X</strong></button></div>'):console.error("Alas! Unknown popup window size: "+size),window.html(output+content),window.removeClass("hidden"),$("#closeWindow").css("visibility","visible"),addGlossaryListeners(window),window.trigger("openModal.kcvs")}function clearWindow(){var window=$("#window");window.hasClass("hidden")||window.trigger("closeModal.kcvs"),window.html(""),window.addClass("hidden"),$("#closeWindow").css("visibility","hidden")}function clearBigWindow(){var window=$("#bigWindow");window.hasClass("hidden")||window.trigger("closeModal.kcvs"),window.html(""),window.addClass("hidden"),$("#closeWindow").css("visibility","hidden")}function showHiddenWindow(name){enableConsoleLogging&&console.log("Showing Hidden Window: "+name),$(name).removeClass("hidden"),$("#closeWindow").css("visibility","visible")}function hideWindow(name){enableConsoleLogging&&console.log("Hiding Shown Window: "+name),$(name).addClass("hidden").trigger("closeModal.kcvs"),$("#closeWindow").css("visibility","hidden")}function hideAllWindows(){enableConsoleLogging&&console.log("hiding all windows"),$(".window:not(.hidden)").addClass("hidden").trigger("closeModal.kcvs")}function updatePopUps(){$(".displayBox").each((function(){$(this).addClass("hidden"),$(this).addClass("window")}))}var glossaryListener=function(e){var term,pos=$(this).offset();enableConsoleLogging&&console.log(pos);var fontSize=parseInt($(this).css("font-size").replace("px",""));showToolTip(term=$(this).attr("data-glossary")?$(this).attr("data-glossary"):$(this).text(),pos.left,pos.top+1.5*fontSize)},addGlossaryListeners=function(element){var targets;(targets=element?element.find(".glossary"):$(".glossary")).on({"click mouseenter":glossaryListener,mouseleave:maybeHideToolTip})};function showToolTip(targetDefinition,x,y){var term=targetDefinition;targetDefinition=(targetDefinition=(targetDefinition=(targetDefinition=(targetDefinition=(targetDefinition=(targetDefinition=targetDefinition.replace(/-/g,"")).replace(/\(/g,"")).replace(/\)/g,"")).replace(/'/g,"")).replace(/:/g,"")).replace(/\s+/g,"")).toLowerCase();var tooltip=$(".tooltipwindow");tooltip.text("Loading Definition...");var seek=folderPath+"glossary.html #"+targetDefinition;tooltip.load(seek,(function(){0==tooltip.text().length&&(console.log("Error: could not find definition at:"+seek),tooltip.text("Error: "+term+" not found in glossary."))})),tooltip.show(),tooltip.offset({left:x,top:y})}function hideToolTip(){$(".tooltipwindow").hide()}addGlossaryListeners(),$(".tooltipwindow").on({click:hideToolTip});var tt=$(".tooltipwindow");function maybeHideToolTip(event){var target;0==$(event.currentTarget).filter(":hover").length&&0==$(".tooltipwindow:hover").length&&hideToolTip()}function showHide(showHideNum,questionAnswerNum){var x=document.getElementById(showHideNum),y=document.getElementById(questionAnswerNum);"none"===x.style.display?(y.style.display="none",x.style.display="block"):(x.style.display="none",y.style.display="block")}function closeAll(){enableConsoleLogging&&console.log("Attempting to closeAll"),clearBigWindow(),clearWindow(),closeMenus(),hideAllWindows(),$("#closeWindow").css("visibility","hidden")}function queryURL(){enableConsoleLogging&&console.log("Querying URL"),contentsData.urlParams={};var queries=window.location.search.slice(1).split("&");for(var par of queries){var q=par.split("=");contentsData.urlParams[q[0]]=q[1]}enableConsoleLogging&&console.log("contentsData.urlParams: "+JSON.stringify(contentsData.urlParams))}function modeCheck(){contentsData.urlParams&&contentsData.urlParams.darkMode&&("true"==contentsData.urlParams.darkMode&&($("body").addClass("darkMode"),delete contentsData.urlParams.darkMode),"false"==contentsData.urlParams.darkMode&&($("body").removeClass("darkMode"),delete contentsData.urlParams.darkMode))}function updateLinks(){$(".darkMode")[0]&&(console.log("Updating Links for DarkMode functionality"),$("#appletContainer a").each((function(){var $this=$(this),href=$this.attr("href");console.log("$this.href: "+href),-1!=href.indexOf("?")?-1!=href.indexOf("darkMode")?($this.attr("href",href),console.log("URL Arguments contains darkMode - keeping old Link: "+href)):($this.attr("href",href+"&darkMode=true"),console.log("URL Arguments already present - new Link: "+href+"&darkMode=true")):($this.attr("href",href+"?darkMode=true"),console.log("URL Arguments not present - new Link: "+href+"?darkMode=true"))})))}$(".tooltipwindow").on({mouseleave:maybeHideToolTip}),document.onkeydown=function(evt){27==(evt=evt||window.event).keyCode&&(enableConsoleLogging&&console.log("Escape Key Pressed"),closeAll())};